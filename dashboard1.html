<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Weather Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background: linear-gradient(to right, #e0f7fa, #ffffff);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .container {
      padding-top: 2rem;
    }
    footer {
      margin-top: 3rem;
      text-align: center;
      color: #6c757d;
    }
    .weather-info {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      margin-top: 2rem;
    }
    .card-weather {
      background-color: #f8f9fa;
      border-radius: 10px;
      padding: 1rem;
      width: 150px;
      text-align: center;
      margin: 0.5rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .card-weather img {
      width: 50px;
      height: 50px;
    }
    .temperature {
      font-weight: bold;
      font-size: 1.2rem;
    }
    .chart-container {
      margin-top: 2rem;
    }
  </style>
</head>
<body>

<div class="container">
  <!-- Navigation -->
  <nav class="mb-4">
    <a href="index.html" class="btn btn-outline-primary">
      <i class="fas fa-arrow-left"></i> Back to Home
    </a>
  </nav>

  <!-- Header -->
  <header class="text-center mb-4">
    <h1 class="display-5">üå¶Ô∏è Weather Dashboard</h1>
    <p class="lead">Real-time weather forecast with visual insights</p>
  </header>

  <!-- Input -->
  <div class="d-flex justify-content-center mb-3">
    <input type="text" id="cityInput" class="form-control me-2" style="max-width: 300px;" placeholder="Enter city name" />
    <button id="fetchBtn" class="btn btn-primary">Get Weather</button>
  </div>

  <!-- Forecast Cards -->
  <div id="forecastCards" class="weather-info"></div>

  <!-- Temperature Chart -->
  <div class="chart-container">
    <canvas id="weatherChart" height="100"></canvas>
  </div>
</div>

<footer>
  <small>¬© 2025 Alis Azwa | Enhanced Weather Dashboard</small>
</footer>

<script>
  const ctx = document.getElementById('weatherChart').getContext('2d');
  let weatherChart;

  function createChart(labels, data) {
    if (weatherChart) {
      weatherChart.destroy();
    }
    weatherChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: labels,
        datasets: [{
          label: 'Temperature (¬∞C)',
          data: data,
          backgroundColor: 'rgba(13, 110, 253, 0.2)',
          borderColor: 'rgb(13, 110, 253)',
          fill: true,
          tension: 0.4
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: true }
        },
        scales: {
          y: {
            beginAtZero: false,
            suggestedMin: 10,
            suggestedMax: 40
          }
        }
      }
    });
  }

  async function fetchWeather(city) {
    const apiKey = '75662820bbc41704ee577bf1ebe9aab8';
    const url = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&units=metric&appid=${apiKey}`;
    try {
      const res = await fetch(url);
      if (!res.ok) {
        alert('City not found or API error');
        return;
      }
      const data = await res.json();

      const temps = [];
      const labels = [];
      const forecastHTML = [];

      const forecastDiv = document.getElementById('forecastCards');
      forecastDiv.innerHTML = '';

      for (let i = 0; i < data.list.length; i += 8) {
        const item = data.list[i];
        const date = new Date(item.dt * 1000);
        const day = date.toLocaleDateString('en-US', { weekday: 'short' });
        const temp = item.main.temp.toFixed(1);
        const icon = item.weather[0].icon;
        const description = item.weather[0].description;

        temps.push(temp);
        labels.push(day);

        forecastHTML.push(`
          <div class="card-weather">
            <div><strong>${day}</strong></div>
            <img src="https://openweathermap.org/img/wn/${icon}@2x.png" alt="${description}" />
            <div class="temperature">${temp}¬∞C</div>
            <small>${description}</small>
          </div>
        `);
      }

      forecastDiv.innerHTML = forecastHTML.join('');
      createChart(labels, temps);

    } catch (err) {
      alert('Error fetching weather data');
      console.error(err);
    }
  }

  document.getElementById('fetchBtn').addEventListener('click', () => {
    const city = document.getElementById('cityInput').value.trim();
    if (city) {
      fetchWeather(city);
    } else {
      alert('Please enter a city name');
    }
  });
</script>

<!-- Font Awesome -->
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</body>
</html>
